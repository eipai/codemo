<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.github.eipai.codemo.benchmark.dao.TransInfoDao">

    <resultMap id="TransInfo" type="com.github.eipai.codemo.benchmark.domain.TransInfo">
        <id column="id" property="id" javaType="long" jdbcType="BIGINT" />
        <result column="order_id" property="orderId" javaType="java.lang.String" jdbcType="VARCHAR" />
        <result column="amount" property="amount" javaType="java.math.BigDecimal" jdbcType="DECIMAL" />
        <result column="payer" property="payer" javaType="long" jdbcType="BIGINT" />
        <result column="receiver" property="receiver" javaType="long" jdbcType="BIGINT" />
        <result column="receivers_info" property="receiversInfo" javaType="java.lang.String" jdbcType="VARCHAR" />
        <result column="account_start" property="accountStart" javaType="boolean" jdbcType="BIT" />
        <result column="account_finish" property="accountFinish" javaType="boolean" jdbcType="BIT" />
        <result column="tran_success" property="tranSuccess" javaType="boolean" jdbcType="BIT" />
        <result column="resp_code" property="respCode" javaType="java.lang.String" jdbcType="VARCHAR" />
        <result column="acct_proc_time" property="acctProcTime" javaType="java.util.Date" jdbcType="TIMESTAMP" />
        <result column="remark" property="remark" javaType="java.lang.String" jdbcType="VARCHAR" />
        <result column="version" property="version" javaType="int" jdbcType="INTEGER" />
        <result column="insert_time" property="insertTime" javaType="java.util.Date" jdbcType="TIMESTAMP" />
        <result column="update_time" property="updateTime" javaType="java.util.Date" jdbcType="TIMESTAMP" />
    </resultMap>


    <select id="get" resultMap="TransInfo" parameterType="long">
        select * from bm_trans_info where id=#{id}
    </select>

    <insert id="insert" keyProperty="entity.id" useGeneratedKeys="true">
        insert into bm_trans_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            id,version,insert_time,update_time
            <if test="entity.orderId!=null">,order_id</if>
            <if test="entity.amount!=null">,amount</if>
            <if test="entity.payer!=null">,payer</if>
            <if test="entity.receiver!=null">,receiver</if>
            <if test="entity.receiversInfo!=null">,receivers_info</if>
            <if test="entity.accountStart!=null">,account_start</if>
            <if test="entity.accountFinish!=null">,account_finish</if>
            <if test="entity.tranSuccess!=null">,tran_success</if>
            <if test="entity.respCode!=null">,resp_code</if>
            <if test="entity.acctProcTime!=null">,acct_proc_time</if>
            <if test="entity.remark!=null">,remark</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            #{entity.id},0,now(),now()
            <if test="entity.orderId!=null">,#{entity.orderId}</if>
            <if test="entity.amount!=null">,#{entity.amount}</if>
            <if test="entity.payer!=null">,#{entity.payer}</if>
            <if test="entity.receiver!=null">,#{entity.receiver}</if>
            <if test="entity.receiversInfo!=null">,#{entity.receiversInfo}</if>
            <if test="entity.accountStart!=null">,#{entity.accountStart}</if>
            <if test="entity.accountFinish!=null">,#{entity.accountFinish}</if>
            <if test="entity.tranSuccess!=null">,#{entity.tranSuccess}</if>
            <if test="entity.respCode!=null">,#{entity.respCode}</if>
            <if test="entity.acctProcTime!=null">,#{entity.acctProcTime}</if>
            <if test="entity.remark!=null">,#{entity.remark}</if>
        </trim>
    </insert>

    <update id="update">
        update bm_trans_info
        <set>
            version=version+1,update_time=now()
            <if test="entity.orderId!=null">,order_id=#{entity.orderId}</if>
            <if test="entity.amount!=null">,amount=#{entity.amount}</if>
            <if test="entity.payer!=null">,payer=#{entity.payer}</if>
            <if test="entity.receiver!=null">,receiver=#{entity.receiver}</if>
            <if test="entity.receiversInfo!=null">,receivers_info=#{entity.receiversInfo}</if>
            <if test="entity.accountStart!=null">,account_start=#{entity.accountStart}</if>
            <if test="entity.accountFinish!=null">,account_finish=#{entity.accountFinish}</if>
            <if test="entity.tranSuccess!=null">,tran_success=#{entity.tranSuccess}</if>
            <if test="entity.respCode!=null">,resp_code=#{entity.respCode}</if>
            <if test="entity.acctProcTime!=null">,acct_proc_time=#{entity.acctProcTime}</if>
            <if test="entity.remark!=null">,remark=#{entity.remark}</if>
        </set>
        where version = #{entity.version}
        and id = #{entity.id}
    </update>
</mapper>
